function RM(pl,sn,s1,s2,s3,s4,s5,gr,sCB,pCB){this.player=pl;this.embed=pl.getElementsByTagName("embed")[0]||null;this.stream=streamInit(sn,s1,s2,s3,s4,s5,gr);this.streamOld=new estat_Object();this.stateCallback=sCB||"";this.positionCallback=pCB||"";this.playStates=new estat_Object();this.playStates[0]=12;this.playStates[1]=1;this.playStates[2]=2;this.playStates[3]=5;this.playStates[4]=7;this.playStates[5]=6;this.eStatPlayState=function(state){return this.playStates[state];};this.initialize=function(){this.stream['cmsPL']='RM';eStat_ms.playerChange(this.player,"polling",null,null);window.setTimeout(function(){eStat_ms.playerChange(pl,"polling",null,null);},10*1000);window.setTimeout(function(){eStat_ms.playerChange(pl,"polling",null,null);},20*1000);window.setTimeout(function(){eStat_ms.playerChange(pl,"polling",null,null);},40*1000);window.setInterval(function(){eStat_ms.playerChange(pl,"polling",null,null);},60*1000);window.setInterval(function(){eStat_ms.playerChange(pl,"state",null,null);},5*1000);};this.update=function(){eStat_er.reset();this.stream['cmsOS']=this.stream['cmsPS'];this.stream['cmsOP']=this.stream['cmsPO'];try{if(this.player.GetMute()){this.stream['cmsSD']=0;}else{this.stream['cmsSD']=this.player.GetVolume();}this.stream['cmsPO']=this.player.GetPosition();this.stream['cmsPS']=this.eStatPlayState(this.player.GetPlayState());this.stream['cmsPV']=this.player.GetVersionInfo();this.stream['cmsME']=encodeURIComponent(this.player.GetSource());if('GetLastMessage' in this.player){this.stream['cmsST']=encodeURIComponent(this.player.GetLastMessage());}else{this.stream['cmsST']=encodeURIComponent(this.player.GetLastStatus());}this.stream['cmsOE']="Object";}catch(e){try{if(this.embed.GetMute()){this.stream['cmsSD']=0;}else{this.stream['cmsSD']=this.embed.GetVolume();}this.stream['cmsPO']=this.embed.GetPosition();this.stream['cmsPS']=this.eStatPlayState(this.embed.GetPlayState());this.stream['cmsPV']=this.embed.GetVersionInfo();this.stream['cmsME']=encodeURIComponent(this.embed.GetSource());if('GetLastMessage' in this.embed){this.stream['cmsST']=encodeURIComponent(this.embed.GetLastMessage());}else{this.stream['cmsST']=encodeURIComponent(this.embed.GetLastStatus());}this.stream['cmsOE']="Embed";}catch(e){}}};};RM.Detect=function(pl){try{pl.GetVersionInfo();}catch(e){try{pl.getElementsByTagName("embed")[0].GetVersionInfo();}catch(e){throw"NoRM";}}};